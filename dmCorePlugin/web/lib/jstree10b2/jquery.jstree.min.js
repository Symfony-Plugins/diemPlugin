(function(c){var a=[],d=-1,e={};c.fn.jstree=function(b){var f=typeof b=="string",h=Array.prototype.slice.call(arguments,1),i=this;!f&&c.meta&&h.push(c.metadata.get(this).jstree);b=!f&&h.length?c.extend.apply(null,[true,b].concat(h)):b;if(f&&b.substring(0,1)=="_")return i;f?this.each(function(){var j=a[c.data(this,"jstree-instance-id")];j=j&&c.isFunction(j[b])?j[b].apply(j,h):j;if(typeof j!=="undefined"){i=j;return false}}):this.each(function(){var j=c.data(this,"jstree-instance-id");j&&a[j]&&a[j].destroy(); j=parseInt(a.push({}),10)-1;c.data(this,"jstree-instance-id",j);var k=c.extend(true,{},c.jstree.defaults,b);if(b.plugins)k.plugins=b.plugins;a[j]=new c.jstree._instance(j,c(this).addClass("jstree jstree-"+j),k);c.each(a[j].get_settings().plugins,function(l,m){a[j].data[m]={}});c.each(a[j].get_settings().plugins,function(l,m){e[m].__init.apply(a[j])});a[j].init()});return i};c.jstree={};c.jstree.defaults={animation:500};c.jstree._focused=function(){return a[d]||null};c.jstree._reference=function(b){if(a[b])return a[b]; b=c(b);b=b.length?b:c("#"+b);if(!b.length)return null;b=b.is(".jstree")?b.get(0):b.parents(".jstree:eq(0)").get(0);b=c.data(b,"jstree-instance-id");return a[b]||null};c.jstree._instance=function(b,f,h){this.data={core:{}};this.get_settings=function(){return c.extend(true,{},h)};this.get_index=function(){return b};this.get_container=function(){return f};this._set_settings=function(i){h=c.extend(true,{},h,i)}};c.jstree._fn=c.jstree._instance.prototype={init:function(){var b=this;this.set_focus();this.get_container().html("<ul><li class='jstree-last jstree-leaf'><ins>&nbsp;</ins><a class='jstree-loading' href='#'><ins class='icon'>&nbsp;</ins>Loading ...</a></li></ul>"); this.data.core.li_height=this.get_container().find("ul li.jstree-closed, ul li.jstree-leaf").eq(0).height()||18;this.load_node(-1,function(){b.loaded()})},destroy:function(){var b,f=this.get_index(),h=this.get_container(),i=this.get_settings(),j=this;c.each(i.plugins,function(k,l){e[l].__destroy.apply(j)});if(this.is_focused())for(b in a)if(a.hasOwnProperty(b)&&b!=f){a[b].set_focus();break}c.removeData(h,"jstree-instance-id");h.removeClass("jstree jstree-"+this.get_index()+" jstree-focused");a[f]= null;delete a[f]},loaded:function(){},set_focus:function(){var b=c.jstree._focused();b&&b!==this&&b.get_container().removeClass("jstree-focused");if(b!==this){this.get_container().addClass("jstree-focused");d=this.get_index()}},is_focused:function(){return d==this.get_index()},_get_node:function(b){var f=c(b,this.get_container());return f.is(".jstree")||b==-1?-1:f.closest("li",this.get_container())},_get_next:function(b,f){b=this._get_node(b);if(!b.length)return false;if(f)return b.nextAll("li").size()> 0?b.nextAll("li:eq(0)"):false;return b.hasClass("jstree-open")?b.find("li:eq(0)"):b.nextAll("li").size()>0?b.nextAll("li:eq(0)"):b.parentsUntil(this.get_container(),"li").next("li").eq(0)},_get_prev:function(b,f){b=this._get_node(b);if(!b.length)return false;if(f)return b.prevAll("li").length>0?b.prevAll("li:eq(0)"):false;if(b.prev("li").length){for(b=b.prev("li").eq(0);b.hasClass("jstree-open");)b=b.children("ul:eq(0)").children("li:last");return b}else{b=b.parentsUntil(this.get_container(),"li:eq(0)"); return b.length?b:false}},_get_parent:function(b){b=this._get_node(b);if(b==-1||!b.length)return false;b=b.parentsUntil(this.get_container(),"li:eq(0)");return b.length?b:-1},_get_children:function(b){b=this._get_node(b);if(b===-1)return this.get_container().children("ul:eq(0)").children("li");if(!b.length)return false;return b.children("ul:eq(0)").children("li")},get_path:function(b,f){var h=[],i=this;b=this._get_node(b);if(b===-1||!b||!b.length)return false;b.parentsUntil(this.get_container(),"li").each(function(){h.push(f? this.id:i.get_text(this))});h.reverse();h.push(f?b.attr("id"):this.get_text(b));return h},get_text:function(b){b=this._get_node(b);if(!b.size())return false;b=b.children("a:eq(0)");b=b.contents().filter(function(){return this.nodeType==3})[0];return b.nodeValue},set_text:function(b,f){b=this._get_node(b);if(!b.size())return false;b=b.children("a:eq(0)");b=b.contents().filter(function(){return this.nodeType==3})[0];return b.nodeValue=f},open_node:function(b,f){b=this._get_node(b);if(!b.length)return false; if(this.is_loaded(b)){this.open_node.supress_callback=false;this.get_settings().animation&&b.children("ul").css("display","none");b.removeClass("jstree-closed").addClass("jstree-open").children("a").removeClass("jstree-loading");this.get_settings().animation&&b.children("ul").slideDown(this.get_settings().animation,function(){this.style.display=""});f&&f.call()}else{var h=this;b.children("a").addClass("jstree-loading");this.load_node(b,function(){h.open_node(b,f)},f);this.open_node.supress_callback= true}},close_node:function(b){b=this._get_node(b);if(!b.length)return false;this.get_settings().animation&&b.children("ul").attr("style","display:block !important");b.removeClass("jstree-open").addClass("jstree-closed");this.get_settings().animation&&b.children("ul").slideUp(this.get_settings().animation,function(){this.style.display=""})},toggle_node:function(b){b=this._get_node(b);if(b.hasClass("jstree-closed"))return this.open_node(b);if(b.hasClass("jstree-open"))return this.close_node(b)},open_all:function(b, f){b=b?this._get_node(b):this.get_container();if(f)b=b.find("li.jstree-closed");else{f=b;b=b.is(".jstree-closed")?b.find("li.jstree-closed").andSelf():b.find("li.jstree-closed")}var h=this;b.each(function(){var i=this;h.open_node(this,function(){h.open_all(i,f)})});this.open_all.supress_callback=!f||f.find("li.jstree-closed").length>0},close_all:function(b){var f=this;b=b?this._get_node(b):this.get_container();b.find("li.jstree-open").andSelf().each(function(){f.close_node(this)})},clean_node:function(b){b= b&&b!=-1?c(b):this.get_container();b=b.is("li")?b.find("li").andSelf():b.find("li");b.removeClass("jstree-last").filter("li:last-child").addClass("jstree-last").end().filter(":has(ul)").not(".jstree-open").removeClass("jstree-leaf").addClass("jstree-closed");b.not(".jstree-open, .jstree-closed").addClass("jstree-leaf")},get_rollback:function(){this.get_rollback.supress_callback=true;return{i:this.get_index(),h:this.get_container().children("ul").clone(true),d:this.data}},load_node:function(){},is_loaded:function(){return true}}; c.jstree.defaults.plugins=[];c.jstree.plugin=function(b,f){f=c.extend(true,{},{__init:function(){},__destroy:function(){},_fn:{},defaults:false},f);e[b]=f;c.each(f._fn,function(h,i){i.plugin=b;i.old=c.jstree._fn[h]});c.extend(c.jstree._fn,f._fn);c.jstree.defaults[b]=f.defaults};var g=["open_node","close_node"];c.jstree.rollback=function(b){if(b){c.isArray(b)||(b=[b]);c.each(b,function(f,h){a[h.i].get_container().empty().append(h.h);a[h.i].data=h.d})}};c.jstree.register_rollback=function(b){b=b.split(" "); c.each(b,function(f,h){g.push(h)})};c(function(){c.each(c.jstree._fn,function(b,f){if(!c.isFunction(f))return true;var h=f,i=false;c.jstree._fn[b]=function(){var j=false;do{if(!f.plugin||f.plugin&&c.inArray(f.plugin,this.get_settings().plugins)!=-1){j=true;break}f=f.old}while(f);if(j){if(!this[b].supress_callback&&b.substring(0,1)!="_"){if(c.inArray(b,g)!==-1)i=this.get_rollback();j=f.apply(this,arguments);this.get_container().triggerHandler("jstree."+b,{arg:Array.prototype.slice.call(arguments), ret:j,rb:i})}else j=f.apply(this,arguments);f=h;return j}}})});c.jstree._css={get_css:function(b,f,h){b=b.toLowerCase();var i=h.cssRules||h.rules,j=0;do{if(i.length&&j>i.length+5)return false;if(i[j].selectorText&&i[j].selectorText.toLowerCase()==b)if(f===true){h.removeRule&&h.removeRule(j);h.deleteRule&&h.deleteRule(j);return true}else return i[j]}while(i[++j]);return false},add_css:function(b,f){if(c.jstree.css.get_css(b,false,f))return false;f.insertRule?f.insertRule(b+" { }",0):f.addRule(b,null, 0);return c.jstree.css.get_css(b)},remove_css:function(b,f){return c.jstree.css.get_css(b,true,f)},add_sheet:function(b){var f;if(b.str){f=document.createElement("style");f.setAttribute("type","text/css");if(f.styleSheet){document.getElementsByTagName("head")[0].appendChild(f);f.styleSheet.cssText=b.str}else{f.appendChild(document.createTextNode(b.str));document.getElementsByTagName("head")[0].appendChild(f)}return f.sheet||f.styleSheet}if(b.url)if(document.createStyleSheet)try{document.createStyleSheet(b.url)}catch(h){}else{f= document.createElement("link");f.rel="stylesheet";f.type="text/css";f.media="all";f.href=b.url;document.getElementsByTagName("head")[0].appendChild(f);return f.styleSheet}}};c(function(){var b=navigator.userAgent.toLowerCase(),f=(b.match(/.+?(?:rv|it|ra|ie)[\/: ]([\d.]+)/)||[0,"0"])[1],h=".jstree ul, .jstree li { display:block; margin:0 0 0 0; padding:0 0 0 0; list-style-type:none; } .jstree li { display:block; min-height:18px; line-height:18px; white-space:nowrap; margin-left:18px; } .jstree > ul > li { margin-left:0px; } .jstree ins { display:inline-block; text-decoration:none; width:18px; height:18px; margin:0 0 0 0; padding:0; } .jstree a { display:inline-block; line-height:16px; height:16px; color:black; white-space:nowrap; text-decoration:none; padding:1px 2px; margin:0; } .jstree a:focus { outline: none; } .jstree a > ins { height:16px; width:16px; } .jstree a > .icon { margin-right:3px; } li.jstree-open > ul { display:block; } li.jstree-closed > ul { display:none; } "; if(/msie/.test(b)&&parseInt(f,10)==6)h+=".jstree li { height:18px; margin-left:0; } .jstree li li { margin-left:18px; } li.jstree-open ul { display:block; } li.jstree-closed ul { display:none !important; } .jstree li a { display:inline; } .jstree li a ins { height:16px; width:16px; margin-right:3px; } ";c.jstree._css.add_sheet({str:h})})})(jQuery); (function(c){c.jstree.plugin("html_data",{__init:function(){this.data.html_data.original_container_html=this.get_container().html().replace(/<\/([^>]+)>\s+</ig,"</$1><").replace(/>\s+<([a-z]{1})/ig,"><$1")},defaults:{data:false,ajax:false,correct_state:false},_fn:{load_node:function(a,d,e){this.load_node_html(a,d,e)},is_loaded:function(a){a=this._get_node(a);return a==-1||!a||!this.get_settings().html_data.ajax||a.is(".jstree-open, .jstree-leaf")||a.children("ul").children("li").size()>0},load_node_html:function(a, d,e){var g,b=this.get_settings().html_data;g=function(){};var f=function(){};switch(true){case !b.data&&!b.ajax:if(!a||a==-1){this.get_container().html(this.data.html_data.original_container_html).find("li, a").filter(function(){return this.firstChild.tagName!=="INS"}).prepend("<ins class='icon'>&nbsp;</ins>");this.clean_node()}d&&d.call();break;case !!b.data&&!b.ajax||!!b.data&&!!b.ajax&&(!a||a===-1):if(!a||a==-1){g=c(b.data);g.is("ul")||(g=c("<ul>").append(g));this.get_container().append(g).find("li, a").filter(function(){return this.firstChild.tagName!== "INS"}).prepend("<ins class='icon'>&nbsp;</ins>");this.clean_node()}d&&d.call();break;case !b.data&&!!b.ajax||!!b.data&&!!b.ajax&&a&&a!==-1:a=this._get_node(a);g=function(h,i,j){var k=this.get_settings().html_data.ajax.error;k&&k.call(this,h,i,j);if(a!=-1&&a.length){a.children(".jstree-loading").removeClass("jstree-loading");b.correct_state&&a.removeClass("jstree-open jstree-closed").addClass("jstree-leaf")}e&&e.call()};f=function(h,i,j){var k=this.get_settings().html_data.ajax.success;if(k)h=k.call(this, h,i,j)||h;h=c(h);h.is("ul")||(h=c("<ul>").append(h));a==-1?this.get_container().html(h).find("li, a").filter(function(){return this.firstChild.tagName!=="INS"}).prepend("<ins class='icon'>&nbsp;</ins>"):a.children(".jstree-loading").removeClass("jstree-loading").append(h).find("li, a").filter(function(){return this.firstChild.tagName!=="INS"}).prepend("<ins class='icon'>&nbsp;</ins>");this.clean_node(a);d&&d.call()};b.ajax.context=this;b.ajax.error=g;b.ajax.success=f;if(c.isFunction(b.ajax.data))b.ajax.data= b.ajax.data.call(null,a);c.ajax(b.ajax);break}}}});c.jstree.defaults.plugins.push("html_data")})(jQuery); (function(c){var a=[];c.jstree._themes=false;c.jstree.plugin("themes",{__init:function(){this.get_container().bind("jstree.init",c.proxy(function(){this.data.themes.dots=this.get_settings().themes.dots;this.data.themes.icons=this.get_settings().themes.icons;this.set_theme(this.get_settings().themes.theme)},this))},defaults:{theme:"default",dots:true,icons:true},_fn:{set_theme:function(d,e){if(!d)return false;e||(e=c.jstree._themes+d+"/style.css");if(c.inArray(e,a)==-1){c.jstree._css.add_sheet({url:e, rel:"jstree"});a.push(e)}if(this.data.theme!=d){this.get_container().removeClass("jstree-"+this.data.theme);this.data.themes.theme=d}this.get_container().addClass("jstree-"+d);this.data.themes.dots?this.show_dots():this.hide_dots();this.data.themes.icons?this.show_icons():this.hide_icons()},get_theme:function(){return this.data.themes.theme},show_dots:function(){this.data.themes.dots=true;this.get_container().children("ul").removeClass("jstree-no-dots")},hide_dots:function(){this.data.themes.dots= false;this.get_container().children("ul").addClass("jstree-no-dots")},toggle_dots:function(){this.data.themes.dots?this.hide_dots():this.show_dots()},show_icons:function(){this.data.themes.icons=true;this.get_container().children("ul").removeClass("jstree-no-icons")},hide_icons:function(){this.data.themes.icons=false;this.get_container().children("ul").addClass("jstree-no-icons")},toggle_icons:function(){this.data.themes.icons?this.hide_icons():this.show_icons()}}});c(function(){c.jstree._themes=== false&&c("script").each(function(){if(this.src.toString().match(/jquery\.jstree[^\/]*?\.js(\?.*)?$/)){c.jstree._themes=this.src.toString().replace(/jquery\.jstree[^\/]*?\.js(\?.*)?$/,"")+"themes/";return false}});if(c.jstree._themes===false)c.jstree._themes="themes/"});c.jstree.defaults.plugins.push("themes")})(jQuery); (function(c){c.jstree.plugin("languages",{__init:function(){this._load_css()},defaults:[],_fn:{set_lang:function(a){var d=this.get_settings().languages,e=false,g=".jstree-"+this.get_index()+" ul li a";if(!c.isArray(d)||d.length===0)return false;if(c.inArray(a,d)==-1)if(d[a])a=d[a];else return false;if(a==this.data.languages.current_language)return true;e=c.jstree._css.get_css(g+"."+this.data.languages.current_language,false,this.data.languages.language_css);if(e!==false)e.style.display="none";e=c.jstree._css.get_css(g+ "."+a,false,this.data.languages.language_css);if(e!==false)e.style.display="";this.data.languages.current_language=a;return true},get_lang:function(){return this.data.languages.current_language},get_text:function(a,d){a=this._get_node(a);if(!a.size())return false;var e=this.get_settings().languages;if(c.isArray(e)&&e.length){d=d&&c.inArray(d,e)!=-1?d:this.data.languages.current_language;a=a.children("a."+d)}else a=a.children("a:eq(0)");a=a.contents().filter(function(){return this.nodeType==3})[0]; return a.nodeValue},set_text:function(a,d,e){a=this._get_node(a);if(!a.size())return false;var g=this.get_settings().languages;if(c.isArray(g)&&g.length){e=e&&c.inArray(e,g)!=-1?e:this.data.languages.current_language;a=a.children("a."+e)}else a=a.children("a:eq(0)");a=a.contents().filter(function(){return this.nodeType==3})[0];return a.nodeValue=d},_load_css:function(){var a=this.get_settings().languages,d="/* languages css */",e=".jstree-"+this.get_index()+" a",g;if(c.isArray(a)&&a.length){this.data.languages.current_language= a[0];for(g=0;g<a.length;g++){d+=e+"."+a[g]+" {";if(a[g]!=this.data.languages.current_language)d+=" display:none; ";d+=" } "}this.data.language_css=c.jstree._css.add_sheet({str:d})}}}});c.jstree.defaults.plugins.push("languages")})(jQuery); (function(c){c.jstree.plugin("types",{__init:function(){this.get_container().bind("jstree.init",c.proxy(function(){var e=this.get_settings().types.types,g=this.get_settings().types.type_attr,b="",f=this,h=[];c.each(e,function(i,j){c.each(j,function(k){/^(max_depth|max_children|icon|valid_children)$/.test(k)||h.push(k)});if(!j.icon)return true;if(j.icon.image||j.icon.position){b+=i=="default"?".jstree-"+f.get_index()+" a > .icon { ":".jstree-"+f.get_index()+" li["+g+"="+i+"] > a >  .icon { ";if(j.icon.image)b+= " background-image:url("+j.icon.image+"); ";b+=j.icon.position?" background-position:"+j.icon.position+"; ":" background-position:0 0; ";b+="} "}});b!=""&&c.jstree._css.add_sheet({str:b});this.enable_rules()},this));if(this.data.move){var a=this.get_settings(),d=a.move.check_move;a.move.check_move=function(e,g){if(this.data.types.enabled&&this._check_type_move(e,g)===false)return false;return d.call(this,e,g)};this._set_settings(a)}},defaults:{max_children:-1,max_depth:-1,valid_children:"all",type_attr:"rel", types:{"default":{max_children:-1,max_depth:-1,valid_children:"all",select_node:true,open_node:true,close_node:true,create_node:true,delete_node:true,cut:true,copy:true,paste:true}}},_fn:{enable_rules:function(){this.data.types.enabled=true},disable_rules:function(){this.data.types.enabled=false},get_type:function(a){a=this._get_node(a);return!a||!a.length?false:a.attr(this.get_settings().types.type_attr)||"default"},set_type:function(a,d){d=this._get_node(d);return!d.length||!a?false:d.attr(this.get_settings().types.type_attr, a)},_check:function(a,d,e){var g=false,b=this.get_type(d),f=0,h=this,i=this.get_settings().types;if(d===-1)if(i[a])g=i[a];else return;else{if(b===false)return;if(i.types[b]&&i.types[b][a])g=i.types[b][a];else if(i.types["default"]&&i.types["default"][a])g=i.types["default"][a]}if(c.isFunction(g))g=g.call(null,d,this);a==="max_depth"&&d!==-1&&e!==false&&i.max_depth!==-2&&g!==0&&this._get_node(d).parentsUntil(this.get_container(),"li").each(function(j){f=h._check(a,this,false);if(f!==-1&&f-(j+1)<=0){g= 0;return false}});return g},_check_type_move:function(a){if(!a.r_t.data.types)return true;var d=a.r_t.get_settings().types,e=a.r_t._check("max_children",a.cr),g=a.r_t._check("max_depth",a.cr),b=a.r_t._check("valid_chidren",a.cr),f=0,h=1;if(b==="none")return false;if(c.isArray(b)&&a.o_t.get_type){a.o.each(function(){if(!c.inArray(a.o_t.get_type(this),b))return h=false});if(h===false)return false}if(d.max_children!==-2&&e!==-1){f=a.cr===-1?this.get_container().children(">  ul > li").not(a.o).length: a.cr.children("> ul > li").not(a.o).length;if(f+a.o.length>e)return false}if(d.max_depth!==-2&&g!==-1){h=0;if(g===0)return false;if(typeof a.o.d==="undefined"){for(d=a.o;d.length>0;){d=d.find(">  ul > li");h++}a.o.d=h}if(g-a.o.d<0)return false}}}});c.jstree.defaults.plugins.push("types")})(jQuery); (function(c){c.jstree.plugin("ui",{__init:function(){this.data.ui.selected=c();this.data.ui.hovered=false;this.get_container().bind("mousedown",c.proxy(function(){this.set_focus()},this));c("li > ins",this.get_container()[0]).live("click",c.proxy(function(a){var d=c(a.target);d.is("ins")&&a.pageY-d.offset().top<this.data.core.li_height&&this.toggle_node(d)},this));c("a",this.get_container()[0]).live("click",c.proxy(function(a){var d=this.get_settings().ui,e=this._get_node(a.currentTarget),g=d.select_multiple_modifier== "on"||d.select_multiple_modifier!==false&&a[d.select_multiple_modifier+"Key"],b=this.is_selected(e);switch(true){case b&&!g:break;case !b&&!g:if(d.select_limit==-1||d.select_limit>0){this.deselect_all();this.select_node(e)}break;case b&&g:this.deselect_node(e);break;case !b&&g:if(d.select_limit==-1||this.data.ui.selected.length+1<=d.select_limit)this.select_node(e);break}a.preventDefault()},this)).live("mouseenter",c.proxy(function(a){this.hover_node(a.target)},this)).live("mouseleave",c.proxy(function(a){this.dehover_node(a.target)}, this));this.get_container().bind("jstree.loaded",c.proxy(function(){var a=this.get_settings().ui;this.data.ui.to_open=c.map(c.makeArray(a.initially_open),function(d){return"#"+d.toString().replace(/^#/,"").replace("\\/","/").replace("/","\\/")});this.data.ui.to_select=c.map(c.makeArray(a.initially_select),function(d){return"#"+d.toString().replace(/^#/,"").replace("\\/","/").replace("/","\\/")});this._restore()},this));this.get_container().bind("jstree.close_node",c.proxy(function(a,d){var e=this.get_settings().ui, g=this._get_node(d.arg[0]);a=g&&g.length?g.find(".jstree-clicked"):[];var b=this;e.selected_parent_close===false||!a.length||a.each(function(){b.deselect_node(this);e.selected_parent_close==="select_parent"&&b.select_node(g)})},this))},defaults:{select_limit:-1,select_multiple_modifier:"ctrl",selected_parent_close:"select_parent",initially_select:[],initially_open:[]},_fn:{hover_node:function(a){a=this._get_node(a);if(!a.length)return false;a.hasClass("jstree-hovered")||this.dehover_node();this.data.ui.hovered= a.children("a").addClass("jstree-hovered").parent()},dehover_node:function(a){a=a?this._get_node(a):this.data.ui.hovered;if(!a||!a.length)return false;a.children("a").removeClass("jstree-hovered")},select_node:function(a){a=this._get_node(a);if(!a.length)return false;if(!this.is_selected(a)){a.children("a").addClass("jstree-clicked");this.data.ui.selected=this.data.ui.selected.add(a)}},deselect_node:function(a){a=this._get_node(a);if(!a.length)return false;if(this.is_selected(a)){a.children("a").removeClass("jstree-clicked"); this.data.ui.selected=this.data.ui.selected.not(a)}},toggle_select:function(a){a=this._get_node(a);if(!a.length)return false;this.is_selected(a)?this.deselect_node(a):this.select_node(a)},is_selected:function(a){return this.data.ui.selected.index(this._get_node(a))>=0},get_selected:function(a){return a?c(a).find(".jstree-clicked").parent():this.data.ui.selected},deselect_all:function(a){a?c(a).find(".jstree-clicked").removeClass("jstree-clicked"):this.get_container().find(".jstree-clicked").removeClass("jstree-clicked"); this.data.ui.selected=c([])},refresh:function(a){var d=this,e=c([]),g=c([]);a=!a||a==1?-1:this._get_node(a);this.data.ui.to_open=[];this.data.ui.to_select=[];e=a==-1?this.get_container().find(".jstree-open"):a.parent().find(".jstree-open");g=a==-1?this.get_container().find(".jstree-clicked").parent():a.parent().find(".jstree-clicked");e.each(function(){d.data.ui.to_open.push("#"+this.id.toString().replace(/^#/,"").replace("\\/","/").replace("/","\\/"))});g.each(function(){d.data.ui.to_select.push("#"+ this.id.toString().replace(/^#/,"").replace("\\/","/").replace("/","\\/"))});this.load_node(a,function(){d._restore()})},delete_node:function(a){a=this._get_node(a);if(!a.length)return false;this.is_selected(a)&&this.deselect_node(a);var d=this._get_parent(a);a=a.remove();this.clean_node(d);return a},_restore:function(){var a=this,d=true,e=[],g=[];if(this.data.ui.to_open.length){c.each(this.data.ui.to_open,function(b,f){if(f=="#")return true;c(f).length&&c(f).is(".jstree-closed")?e.push(f):g.push(f)}); if(e.length){this.data.ui.to_open=g;c.each(e,function(b,f){a.open_node(f,function(){a._restore(true)})});d=false}}d&&c.each(this.data.ui.to_select,function(b,f){a.select_node(f)})}}});c.jstree.defaults.plugins.push("ui");c.jstree.register_rollback("select_node deselect_node")})(jQuery); (function(c){c.jstree.plugin("cookies",{__init:function(){if(typeof c.cookie==="undefined")throw"jsTree cookie: jQuery cookie plugin not included.";var a=this.get_settings().cookies;a.open&&this.get_container().bind("jstree.open_node",c.proxy(function(){this._set_cookie("open")},this)).bind("jstree.close_node",c.proxy(function(){this._set_cookie("open")},this));a.select&&this.get_container().bind("jstree.select_node",c.proxy(function(){this._set_cookie("select")},this)).bind("jstree.deselect_node", c.proxy(function(){this._set_cookie("select")},this))},defaults:{open:"jstree_open",select:"jstree_select",options:{}},_fn:{_restore:function(a){if(!a){var d=this.get_settings().cookies,e=[];if(e=c.cookie(d.open)){e=e.split(",");if(e.length)this.data.ui.to_open=e}if(e=c.cookie(d.select)){e=e.split(",");if(e.length)this.data.ui.to_select=e}}arguments.callee.old.call(this)},_set_cookie:function(a){var d=this.get_settings().cookies,e=[];if(d[a]){switch(a){case "open":this.get_container().find(".jstree-open").each(function(){this.id&& e.push("#"+this.id.toString().replace(/^#/,"").replace("\\/","/").replace("/","\\/"))});break;case "select":this.get_container().find(".jstree-clicked").parent().each(function(){this.id&&e.push("#"+this.id.toString().replace(/^#/,"").replace("\\/","/").replace("/","\\/"))});break}c.cookie(d[a],e,d.options)}}}});c.jstree.defaults.plugins.push("cookies")})(jQuery); (function(c){function a(e){var g=c.jstree._focused();if(g&&g.data.hotkeys.enabled)return g.get_settings().hotkeys[e].apply(g)}var d=[];c.jstree.plugin("hotkeys",{__init:function(){if(typeof window.hotkeys=="undefined")throw"jsTree hotkeys: jQuery hotkeys plugin not included.";c.each(this.get_settings().hotkeys,function(e){if(c.inArray(e,d)==-1){c(document).bind("keydown",{combi:e,disableInInput:true},function(){return a(e)});d.push(e)}});this.enable_hotkeys()},defaults:{up:function(){this.hover_node(this._get_prev(this.data.ui.hovered|| this.data.ui.selected[this.data.ui.selected.length-1]));return false},down:function(){this.hover_node(this._get_next(this.data.ui.hovered||this.data.ui.selected[this.data.ui.selected.length-1]));return false},left:function(){var e=this.data.ui.hovered||this.data.ui.selected[this.data.ui.selected.length-1];if(e)e.hasClass("jstree-open")?this.close_node(e):this.hover_node(this._get_prev(e));return false},right:function(){var e=this.data.ui.hovered||this.data.ui.selected.eq(this.data.ui.selected.length- 1);if(e&&e.length)e.hasClass("jstree-closed")?this.open_node(e):this.hover_node(this._get_next(e));return false},space:function(){this.data.ui.hovered&&this.data.ui.hovered.children("a:eq(0)").click();return false}},_fn:{enable_hotkeys:function(){this.data.hotkeys.enabled=true},disable_hotkeys:function(){this.data.hotkeys.enabled=false}}});c.jstree.defaults.plugins.push("hotkeys")})(jQuery); (function(c){c.expr[":"].jstree_contains=function(a,d,e){return(a.textContent||a.innerText||"").toLowerCase().indexOf(e[3].toLowerCase())>=0};c.jstree.plugin("search",{__init:function(){this.data.search.str="";this.data.search.result=c([])},defaults:{ajax:false,case_insensitive:false},_fn:{search:function(a,d){var e=this.get_settings().search,g=function(){},b=function(){};this.data.search.str=a;if(!d&&e.ajax!==false&&this.get_container().find(".jstree-closed:eq(0)").length>0){this.search.supress_callback= true;g=function(){};b=function(f){this.data.search.to_open=f;this._search_open()};e.ajax.error=e.ajax.error?function(f,h,i){e.ajax.error.call(null,f,h,i);g.call()}:g;e.ajax.success=e.ajax.success?function(f,h,i){f=e.ajax.success.call(null,f,h,i)||f;b.call(this,f)}:b;if(c.isFunction(e.ajax.data))e.ajax.data=e.ajax.data.call(this);if(!e.ajax.dataType||/^json/.exec(e.ajax.dataType))e.ajax.dataType="json";c.ajax(e.ajax)}else{this.search.supress_callback=false;this.clear_search();this.data.search.result= this.get_container().find("a:"+(e.case_insensitive?"jstree_contains":"contains")+"("+this.data.search.str+")").filter(":visible");this.data.search.result.addClass("jstree-search")}},clear_search:function(){this.data.search.result.removeClass("jstree-search")},_search_open:function(){var a=this,d=true,e=[],g=[];if(this.data.search.to_open.length){c.each(this.data.search.to_open,function(b,f){if(f=="#")return true;c(f).length&&c(f).is(".jstree-closed")?e.push(f):g.push(f)});if(e.length){this.data.search.to_open= g;c.each(e,function(b,f){a.open_node(f,function(){a._search_open(true)})});d=false}}d&&this.search(this.data.search.str,true)}}});c.jstree.defaults.plugins.push("search")})(jQuery); (function(c){c.jstree.plugin("checkbox",{__init:function(){this.get_container().bind("jstree.open_node",c.proxy(function(a,d){this._prepare_checkboxes(d.arg[0])},this)).bind("jstree.loaded",c.proxy(function(){this._prepare_checkboxes()},this)).bind("jstree.clean_node",c.proxy(function(a,d){this._repair_state(d.arg[0])},this));if(this.get_settings().checkbox.override_select){this.hover_node=this.dehover_node=this.select_node=this.deselect_node=this.deselect_all=c.noop;this.get_selected=this.get_checked; c("a",this.get_container()).live("click",c.proxy(function(a){this.change_state(a.target);a.preventDefault()},this))}else c(".checkbox",this.get_container()).live("click",c.proxy(function(a){this.change_state(a.target);a.stopImmediatePropagation();return false},this))},defaults:{override_select:true},_fn:{_prepare_checkboxes:function(a){a=!a||a==-1?this.get_container():this._get_node(a);var d=a.is("li")&&a.hasClass("jstree-checked")?"jstree-checked":"jstree-unchecked";a.find("a").not(":has(.checkbox)").prepend("<ins class='checkbox'>&nbsp;</ins>").parent().addClass(d)}, change_state:function(a,d){a=this._get_node(a);(d=d===false||d===true?d:a.hasClass("jstree-checked"))?a.find("li").andSelf().removeClass("jstree-checked jstree-undetermined").addClass("jstree-unchecked"):a.find("li").andSelf().removeClass("jstree-unchecked jstree-undetermined").addClass("jstree-checked");var e=this;a.parentsUntil(this.get_container(),"li").each(function(){var g=c(this);if(d)if(g.children("ul").children(".jstree-checked").length){g.parentsUntil(e.get_container(),"li").andSelf().removeClass("jstree-checked jstree-unchecked").addClass("jstree-undetermined"); return false}else g.removeClass("jstree-checked jstree-undetermined").addClass("jstree-unchecked");else if(g.children("ul").children(".jstree-unchecked, .jstree-undetermined").length){g.parentsUntil(e.get_container(),"li").andSelf().removeClass("jstree-checked jstree-unchecked").addClass("jstree-undetermined");return false}else g.removeClass("jstree-unchecked jstree-undetermined").addClass("jstree-checked")})},check_node:function(a){this.change_state(a,false)},uncheck_node:function(a){this.change_state(a, true)},check_all:function(){var a=this;this.get_container().children("ul").children("li").each(function(){a.check_node(this,false)})},uncheck_all:function(){var a=this;this.get_container().children("ul").children("li").each(function(){a.check_node(this,true)})},is_checked:function(a){a=this._get_node(a);return a.length?a.is(".jstree-checked"):false},get_checked:function(a){a=!a||a===-1?this.get_container():this._get_node(a);return a.find("> ul > .jstree-checked, .jstree-undetermined > ul >  .jstree-checked")}, get_unchecked:function(a){a=!a||a===-1?this.get_container():this._get_node(a);return a.find("> ul > .jstree-unchecked, .jstree-undetermined > ul > .jstree-unchecked")},show_checkboxes:function(){this.get_container().children("ul").removeClass("jstree-no-checkboxes")},hide_checkboxes:function(){this.get_container().children("ul").addClass("jstree-no-checkboxes")},_repair_state:function(a){a=this._get_node(a);if(a.length){var d=a.find("> ul > .jstree-checked").length,e=a.find("> ul > li").length;if(e=== 0)a.hasClass("jstree-undetermined")&&this.check_node(a);else if(d===0)this.uncheck_node(a);else d===e?this.check_node(a):a.parentsUntil(this.get_container(),"li").andSelf().removeClass("jstree-checked jstree-unchecked").addClass("jstree-undetermined")}}}});c.jstree.defaults.plugins.push("checkbox")})(jQuery); (function(c){c.jstree._move={data:{},is_down:false,is_drag:false,prepare_drag:function(a,d,e,g){e||(e=d?d.get_text(a):"Dragged node");c.jstree._move.is_down=true;c.jstree._move.data={o:a,o_t:d?d:false,hlp:c("<div id='jstree-dragged'><ins>&nbsp;</ins>"+e+"</div>").css("opacity","0.75"),init_x:g?g.pageX:false,init_y:g?g.pageY:false};c(document).bind("mousemove",c.jstree._move.drag);c(document).bind("mouseup",c.jstree._move.stop_drag)},start_drag:function(){c.jstree._move.is_drag=true;c.jstree._move.data.hlp.appendTo("body"); c(document).triggerHandler("jstree.start_drag",{move:c.jstree._move.data})},drag:function(a){if(c.jstree._move.is_down){if(!c.jstree._move.is_drag)if(Math.abs(a.pageX-c.jstree._move.data.init_x)>5||Math.abs(a.pageY-c.jstree._move.data.init_y)>5)c.jstree._move.start_drag();else return;try{if(c.jstree._move.data.state===1&&a.target.id!=="jstree-marker"&&c.jstree._move.data.r&&!c.contains(c.jstree._move.data.r.get(0),a.target))c.jstree._move.data.state=0}catch(d){}c(document).triggerHandler("jstree.drag", {move:c.jstree._move.data,event:a});c.jstree._move.data.hlp.css({left:a.pageX+5+"px",top:a.pageY+10+"px"}).attr("class",function(){if(c.jstree._move.data.state===1)return"jstree-ok";if(c.jstree._move.data.state===0)return"jstree-invalid"})}},stop_drag:function(a){c.jstree._move.is_down=false;if(c.jstree._move.is_drag){c.jstree._move.is_drag=false;c.jstree._move.data.hlp.remove();c(document).unbind("mousemove",c.jstree._move.drag);c(document).unbind("mouseup",c.jstree._move.stop_drag);c(document).triggerHandler("jstree.stop_drag", {move:c.jstree._move.data});a!==true&&c.jstree._move.data.o_t!==-1&&c.jstree._move.data.r_t!==-1&&c.jstree._move.data.state===1&&c.jstree._move.data.r_t.move(c.jstree._move.data,false,false,false,true,true)}c.jstree._move.data={}}};c.jstree.plugin("move",{__init:function(){var a=this.get_settings().move;this.data.move={};a.drag_n_drop&&c("a",this.get_container()[0]).live("mousedown",c.proxy(function(d){try{d.currentTarget.unselectable="on";d.currentTarget.onselectstart=function(){return false};if(d.currentTarget.style)d.currentTarget.style.MozUserSelect= "none"}catch(e){}var g=this._get_node(d.currentTarget);c.jstree._move.prepare_drag(g,this,this.get_text(g),d);return false},this)).live("mousemove",c.proxy(function(d){c.jstree._move.is_drag&&this._check_move(this._prepare_move(false,d.currentTarget,"inside"))},this))},defaults:{move_from:[],move_to:[],always_copy:false,copy_modifier:"ctrl",drag_n_drop:true,default_position:"bottom",check_move:function(){}},_fn:{_check_move:function(a){var d,e;if(a===false)return false;if(a===-1)return c.jstree._move.data.state= -1;if(a.r.get(0)===a.o.get(0)||(a.r_t&&a.r_t!==1&&a.o.index(a.r.parentsUntil(a.r_t.get_container(),"li").andSelf()))!==-1){c.jstree._move.data.state=0;return false}if(a.o_t!==a.r_t&&a.o_t!==-1){d=a.o_t.get_settings().move;e=a.r_t.get_settings().move;if(d.move_to==="none"||d.move_to.length===0||e.move_from==="none"||e.move_from.length===0){c.jstree._move.data.state=0;return false}if(d.move_to!=="all"&&!a.r_t.get_container().is(d.move_to.join(","))||e.move_from!=="all"&&!a.o_t.get_container().is(e.move_from.join(","))){c.jstree._move.data.state= 0;return false}}d=this.get_settings().move.check_move.apply(this,arguments);if(d===true){c.jstree._move.data.state=1;return true}if(d===false){c.jstree._move.data.state=0;return false}c.jstree._move.data.state=1;return true},_prepare_move:function(a,d,e,g){var b=c.jstree._move.data,f=this.get_settings().move,h=this;if(!b.o_t)b.o_t=c.jstree._reference(a);if(!b.o_t)return false;if(a)b.o=b.o_t._get_node(a);b.r=d==-1?-1:this._get_node(d);if(b.r!=-1&&(!b.r||!b.r.length))return false;b.r_t=this;b.p=e|| f.default_position;if(b.r==-1){b.cr=-1;switch(b.p){case "top":case "before":b.cp=0;break;case "after":case "bottom":b.cp=b.r_t.get_container().find(" > ul > li").length;break;default:b.cp=b.p;break}}else{if(!/^(before|after)$/.test(b.p)&&!this.is_loaded(b.r)){this.load_node(b.r,function(){h.prepare_move(a,d,e,g)});return false}switch(b.p){case "before":b.cp=b.r.index();b.cr=b.r_t._get_parent(b.r);break;case "after":b.cp=b.r.index();b.cr=b.r_t._get_parent(b.r);break;case "inside":case "top":b.cp=0; b.cr=b.r;break;case "bottom":b.cp=b.r.find(" > ul > li").length;b.cr=b.r;break;default:b.cp=b.p;b.cr=b.r;break}}g&&g.call(this,b);return b},move:function(a,d,e,g,b,f){var h=this,i,j;this.move.supress_callback=true;if(f){if(!(!b&&this._check_move(a,g)===false)){this.move.supress_callback=false;d=a.cr==-1?a.r_t.get_container():a.cr;f=d.children("ul:eq(0)");f.length||(f=c("<ul>").appendTo(d));e=a.o_t._get_parent(a.o);i=f.children("li:nth-child("+(a.cp+1)+")");j=false;if(g){j=a.o.clone();j.find("*[id]").andSelf().each(function(){if(this.id)this.id= "copy_"+this.id})}else j=a.o;i.length?i.before(j):f.append(j);try{a.o_t.clean_node(e);a.r_t.clean_node(d)}catch(k){}}}else this._prepare_move(a,d,e,function(l){h.move(l,false,false,g,b,true)})},cut:function(a){c.jstree._move.data.o=a;c.jstree._move.data.t="cut"},copy:function(a){this.cut(a);c.jstree._move.data.t="copy"},paste:function(a,d){this.move(c.jstree._move.data.o,a,d,c.jstree._move.data.t==="copy")}}});c(function(){c.jstree._css.add_sheet({str:"#jstree-dragged { display:block; margin:0 0 0 0; padding:4px 4px 4px 24px; position:absolute; left:-2000px; top:-2000px; line-height:18px; border:1px solid red; } #jstree-dragged ins { background:gray; display:block; text-decoration:none; width:18px; height:18px; margin:0 0 0 0; padding:0; position:absolute; top:4px; left:4px; } #jstree-dragged.jstree-ok ins { background:green; } #jstree-dragged.jstree-invalid ins { background:red; } "})}); c.jstree.defaults.plugins.push("move");c.jstree.register_rollback("move")})(jQuery); (function(c){c.jstree.plugin("json_data",{defaults:{data:false,ajax:false,correct_state:false,progressive_render:false},_fn:{load_node:function(a,d,e){this.load_node_json(a,d,e)},is_loaded:function(a){var d=this.get_settings().json_data;if((a=this._get_node(a))&&a!==-1&&d.progressive_render){a.append(this.parse_json(a.data("jstree-children")));c.removeData(a,"jstree-children")}return a==-1||!a||!d.ajax||a.is(".jstree-open, .jstree-leaf")||a.children("ul").children("li").size()>0},load_node_json:function(a, d,e){var g=this.get_settings().json_data,b=function(){},f=function(){};switch(true){case !g.data&&!g.ajax:throw"Neither data nor ajax settings supplied.";case !!g.data&&!g.ajax||!!g.data&&!!g.ajax&&(!a||a===-1):if(!a||a==-1){this.get_container().empty().append(this.parse_json(g.data));this.clean_node()}d&&d.call();break;case !g.data&&!!g.ajax||!!g.data&&!!g.ajax&&a&&a!==-1:a=this._get_node(a);b=function(h,i,j){var k=this.get_settings().json_data.ajax.error;k&&k.call(this,h,i,j);if(a!=-1&&a.length){a.children(".jstree-loading").removeClass("jstree-loading"); g.correct_state&&a.removeClass("jstree-open jstree-closed").addClass("jstree-leaf")}e&&e.call()};f=function(h,i,j){var k=this.get_settings().json_data.ajax.success;if(k)h=k.call(this,h,i,j)||h;a==-1?this.get_container().empty().append(this.parse_json(h)):a.children(".jstree-loading").removeClass("jstree-loading").parent().append(this.parse_json(h));this.clean_node(a);d&&d.call()};g.ajax.context=this;g.ajax.error=b;g.ajax.success=f;if(c.isFunction(g.ajax.data))g.ajax.data=g.ajax.data.call(null,a); c.ajax(g.ajax);break}},parse_json:function(a,d){var e=c(),g,b,f;b=this.get_settings().json_data;if(!a)return e;if(c.isFunction(a))a=a.call(this);if(c.isArray(a)){b=0;for(f=a.length;b<f;b++){g=this.parse_json(a[b],true);if(g.length)e=e.add(g)}}else{if(!a.data)return e;e=c("<li>");a.attr&&e.attr(a.attr);a.state&&e.addClass("jstree-"+a.state);if(!c.isArray(a.data)){g=a.data;a.data=[];a.data.push(g)}c.each(a.data,function(h,i){g=c("<a>");if(c.isFunction(i))i=i.call(this,a);if(typeof i=="string")g.attr("href", "#").text(i);else{if(!i.attr)i.attr={};if(!i.attr.href)i.attr.href="#";g.attr(i.attr).text(i.title);i.language&&g.addClass(i.language);if(i.icon)i.icon.indexOf("/")===-1?g.addClass(i.icon):g.children("ins").css("background","url('"+i.icon+"') center center no-repeat;")}g.prepend("<ins class='icon'>&nbsp;</ins>");e.append(g)});e.prepend("<ins class='icon'>&nbsp;</ins>");if(a.children)if(b.progressive_render&&a.state!=="open")e.data("jstree-children",a.children);else{if(c.isFunction(a.children))a.children= a.children.call(this,a);if(c.isArray(a.children)&&a.children.length){g=this.parse_json(a.children,true);if(g.length){b=c("<ul>");b.append(g);e.append(b)}}}}if(!d){d=c("<ul>");d.append(e);e=d}return e}}})})(jQuery);